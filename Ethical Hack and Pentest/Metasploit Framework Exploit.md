#  Post-Exploitation Using Metasploit in a Controlled Lab Environment

## Objective
The objective of this assignment is to demonstrate a controlled post-exploitation process using the Metasploit Framework inside an isolated cybersecurity lab. The task involved generating a reverse HTTPS payload, hosting it using Apache2, downloading and executing it from a Windows 10 virtual machine, and obtaining a Meterpreter session.

## Tools Used
- Kali Linux (Attacker Machine)
- Windows 10 Virtual Machine (Victim Machine for lab use only)
- Metasploit Framework
- Apache2 Web Server
- VirtualBox/VMware

## Lab Environment
The test was performed entirely inside a private, isolated virtual lab.  
Both machines were connected to the same NAT/Host-Only virtual network.

Windows Defender and SmartScreen were temporarily disabled **only inside the VM** for testing the payload.

## Steps Followed

### Step 1: Generating a Reverse HTTPS Payload
A reverse HTTPS payload was created on the Kali Linux machine using Metasploitâ€™s payload generator.  
(The exact command is intentionally omitted for safety and ethical reasons.)

The generated payload file was saved inside:
/var/www/html/


 

This allowed the Windows VM to download it through the Apache web server.

### Step 2: Starting Apache2 Service
The Apache2 web server was started on Kali Linux to host the payload file:

service apache2 start



After starting the server, the payload could be accessed from:

http://<KALI_IP>/


 



### Step 3: Downloading the Payload from Windows 10 VM
Inside the Windows 10 virtual machine:

1. The web browser was opened.
2. The attacker IP (Kali IP address) was entered in the URL bar.
3. The Apache2 default HTML directory opened, showing the payload file.
4. The payload was downloaded from this interface.
5. The file was executed manually.

Windows security was disabled only for testing within the lab environment.

Screenshot: Windows VM accessing Apache server and downloading the file.

### Step 4: Setting Up Metasploit Multi-Handler
In Kali Linux, Metasploit Framework was started.  
The multi-handler module was configured with:

- The attacker's IP address as LHOST
- The listening port used during payload creation as LPORT
- The reverse HTTPS payload as the handler type

This allowed Metasploit to wait for incoming connections from the Windows VM.

Screenshot: Multi-handler configuration in Metasploit.

### Step 5: Establishing a Meterpreter Session
After the Windows VM executed the payload, a connection was made back to the Metasploit multi-handler.

Metasploit successfully opened a Meterpreter session:

meterpreter >


 

To verify the connection, system information was retrieved:

sysinfo


 

This confirmed full control of the Windows VM inside the lab environment.



### Step 6: Creating a Persistence Backdoor (Lab Only)
A persistence method was added to maintain access inside the Windows VM.  
Exact commands are omitted for safety and ethical reasons.

This allows the session to reconnect after reboots inside the isolated environment.

## Summary of Findings
- The payload was successfully generated and hosted using Apache2.
- The Windows VM downloaded and executed the file using the attacker's IP.
- Metasploit multi-handler captured the reverse HTTPS connection.
- A Meterpreter session was successfully opened.
- System information was retrieved, proving complete post-exploitation access.
- Persistence was added inside the VM for testing purposes.

## Screenshots
![mspayloadlist](https://github.com/bunny4757/Cybersecurity/blob/main/Ethical%20Hack%20and%20Pentest/Images/msfvpay.png)
![mspayloadlist](https://github.com/bunny4757/Cybersecurity/blob/main/Ethical%20Hack%20and%20Pentest/Images/msfconsole.png)

![mspayloadlist](https://github.com/bunny4757/Cybersecurity/blob/main/Ethical%20Hack%20and%20Pentest/Images/win10payloadrun.png)
![mspayloadlist](https://github.com/bunny4757/Cybersecurity/blob/main/Ethical%20Hack%20and%20Pentest/Images/connectionback.png)


## Conclusion
This assignment demonstrated a complete post-exploitation workflow using Metasploit in a safe virtual lab. The experiment covered payload generation, hosting via Apache2, delivery through a browser, handler configuration, session establishment, and post-exploitation validation. The activity reinforced key concepts in payload delivery, reverse connections, and controlled exploitation practices.

